--VISTA ENCRIPTADA--

--HACIENDO USO DE LA TABLA CLIENTE Y TARJETA--
--CREAMOS LA VISTA QUE SOLO NOS MUESTRE EL ID DEL CLIENTE NUMERO, Y CVV (ENCRIPTADO)--

--CREAMOS LA VISTA SIN ENCRIPTAR--

CREATE VIEW CLIENTE_TARJETA AS
SELECT ID_CLIENTE, NUMERO, CVV
FROM TARJETA;
GO

--HACEMOS UN SELECT PARA VER LOS CAMPOS--

SELECT * FROM CLIENTE_TARJETA
GO

--BORRAMOS LA VISTA ANTERIOR--

DROP VIEW CLIENTE_TARJETA
GO

--CREAMOS LA VISTA ENCRIPTADA--

CREATE VIEW CLIENTE_TARJETA AS
SELECT ID_CLIENTE, NUMERO, CONVERT(VARCHAR(50), ENCRYPTBYKEY(KEY_GUID('STASHMOTOR'), CVV)) AS CVV
FROM TARJETA;
GO

--HACEMOS NUEVAMENTE UN SELECT SOBRE LA VISTA--
--ESTA VEZ NO SOMOS CAPACES DE VISUALIZAR EL CAMPO CVV--

SELECT * FROM CLIENTE_TARJETA
GO


























DROP VIEW Vista_Tarjetas_Clientes
GO




